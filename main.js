(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{ri:()=>b,D7:()=>B,Ob:()=>N,q:()=>z,j4:()=>n,Rm:()=>R,mD:()=>U,Ml:()=>H,Mw:()=>o,hE:()=>T,hC:()=>j,t1:()=>P,Ag:()=>O,jQ:()=>G,vD:()=>C,E3:()=>M});var t=document.querySelector(".page");function o(e){e.classList.add("popup_opened"),t.addEventListener("keydown",r)}function n(e){e.classList.remove("popup_opened"),t.removeEventListener("keydown",r)}function r(e){"Escape"===e.key&&n(document.querySelector(".popup_opened"))}var c=document.querySelector(".page"),a=c.querySelector(".popup_type_photo"),u=(c.querySelector(".popup_type_profile"),c.querySelector(".popup_type_big-picture"));function p(e,t,n,r,c,a){var p=z.querySelector(".element").cloneNode(!0),i=p.querySelector(".element__image"),l=p.querySelector(".element__like");p.querySelector(".element__text").textContent=e,p.querySelector(".element__like-number").textContent=n,p.querySelector(".element__image").src=t,p.querySelector(".element__image").alt=e,p.querySelector(".element__id").textContent=c,i.addEventListener("click",(function(){B.src=t,B.alt=e,N.textContent=e,o(u)})),p.querySelector(".element__like").addEventListener("click",(function(e){e.target.classList.contains("element__like_type_active")?(fetch("https://nomoreparties.co/v1/plus-cohort-14/cards/likes/".concat(c),{method:"DELETE",headers:{authorization:"54da0c89-ce48-4884-99bf-abf92ea9ad7d","Content-Type":"application/json"}}),e.target.classList.remove("element__like_type_active")):fetch("https://nomoreparties.co/v1/plus-cohort-14/cards/likes/".concat(c),{method:"PUT",headers:{authorization:"54da0c89-ce48-4884-99bf-abf92ea9ad7d","Content-Type":"application/json"}}),e.target.classList.add("element__like_type_active")}));var s=p.querySelector(".element__delete");return s.addEventListener("click",(function(){var e=s.closest(".element");fetch("https://nomoreparties.co/v1/plus-cohort-14/cards/".concat(c),{method:"DELETE",headers:{authorization:"54da0c89-ce48-4884-99bf-abf92ea9ad7d","Content-Type":"application/json"}}).then((function(e){return e.json()})),e.remove()})),H!==r&&s.classList.add("element__delete_inactive"),a&&l.classList.add("element__like_type_active"),p}function i(e,t,o){!function(e){return Array.from(e).some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(o.inactiveButton),t.removeAttribute("disabled",!0)):(t.classList.add(o.inactiveButton),t.setAttribute("disabled",!0))}var l={baseURL:"https://nomoreparties.co/v1/plus-cohort-14",headers:{authorization:"54da0c89-ce48-4884-99bf-abf92ea9ad7d","Content-Type":"application/json"}};function s(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status," ").concat(e.statusText))}t.querySelector(".popup");var _=document.querySelectorAll(".popup"),d=t.querySelector(".popup_type_profile"),y=t.querySelector(".popup_type_avatar"),f=t.querySelector(".popup_type_photo"),m=t.querySelector(".popup_type_big-picture"),v=t.querySelector(".profile__edit-button"),h=(t.querySelector(".popup__button-close_type_profile"),t.querySelector(".popup__button-close_type_avatar"),t.querySelector(".popup__form_type_profile")),S=t.querySelector(".profile__add-button"),q=(t.querySelector(".popup__button-close_type_photo"),t.querySelector(".popup__form_type_photo")),b=t.querySelector(".profile__avatar"),L=document.querySelector(".popup__button-save_type_avatar"),E=document.querySelector(".popup__button-save_type_profile"),C=document.querySelector(".popup__button-save_type_photo"),g=t.querySelector(".profile__info"),k=document.querySelector(".popup__input_type_name"),x=document.querySelector(".popup__input_type_status"),j=document.querySelector(".popup__input_type_picName"),T=document.querySelector(".popup__input_type_picHref"),A=document.querySelectorAll(".popup__input"),D=document.querySelector("#avatar-input"),O=g.querySelector(".profile__title"),P=g.querySelector(".profile__subtitle"),w=document.querySelector("#form-edit-avatar"),R=t.querySelector(".elements"),U=(document.querySelector("#card-template"),t.querySelector(".elements")),z=document.querySelector("#card-template").content,B=(t.querySelector(".popup__button-close_type_big-picture"),m.querySelector(".popup__image")),N=m.querySelector(".popup__description"),H={id:""};_.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&n(e),t.target.classList.contains("popup__button-close")&&n(e)}))})),S.addEventListener("click",(function(){o(f),i(A,C,M)})),b.addEventListener("click",(function(){return o(y)})),v.addEventListener("click",(function(){k.value=O.textContent,x.value=P.textContent,o(d)})),q.addEventListener("submit",(function(e){e.preventDefault(),G(!0,C);var t,o,r=p(j.value,T.value);U.prepend(r),n(a),t=j.value,o=T.value,fetch("https://nomoreparties.co/v1/plus-cohort-14/cards",{method:"POST",headers:{authorization:"54da0c89-ce48-4884-99bf-abf92ea9ad7d","Content-Type":"application/json"},body:JSON.stringify({name:t,link:o})}).then((function(e){return e.json()})),e.target.reset()})),h.addEventListener("submit",(function(e){var t,o,r,c;e.preventDefault(),G(!0,E),r=k.value,c=x.value,O.textContent=r,P.textContent=c,t=O.textContent,o=P.textContent,fetch("".concat(l.baseURL,"/users/me"),{method:"PATCH",headers:l.headers,body:JSON.stringify({name:t,about:o})}).then((function(e){s(e)})).catch((function(e){console.log(e)})),k.value=O.textContent,x.value=P.textContent,n(d)}));var J,M={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active",inactiveButton:"popup__button-save_inactive"};function G(e,t){t.textContent=e?"Coхранение...":"Сохранить"}J=M,Array.from(document.querySelectorAll(J.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);i(o,n,M),o.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,o){t.validity.valid?function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(o.inputErrorClass),n.classList.remove(o.errorClass),n.textContent=""}(e,t,o):function(e,t,o,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n.inputErrorClass),r.textContent=o,r.classList.add(n.errorClass)}(e,t,t.validationMessage,o)}(e,r,t),i(o,n,M)}))}))}(e,J)})),[].forEach((function(e){var t=p(e.name,e.link);R.append(t)})),fetch("".concat(l.baseURL,"/cards"),{method:"GET",headers:l.headers}).then((function(e){return e.json()})).then((function(e){console.log(e),e.forEach((function(e){var t=e.likes.some((function(e){return e._id===H.id})),o=p(e.name,e.link,e.likes.length,e.owner._id,e._id,t);R.append(o)}))})).catch((function(e){console.log(e)})),fetch("".concat(l.baseURL,"/users/me"),{method:"GET",headers:l.headers}).then((function(e){return e.json()})).then((function(e){return O.textContent=e.name,P.textContent=e.about,b.src=e.avatar,H.id=e._id,console.log(e),H})).catch((function(e){console.log(e)})),w.addEventListener("submit",(function(e){G(!0,L),e.preventDefault(),function(e){fetch("".concat(l.baseURL,"/users/me/avatar"),{method:"PATCH",headers:l.headers,body:JSON.stringify({avatar:e})}).then((function(e){return s(e)})).catch((function(e){console.log(e)}))}(D.value),b.src=D.value,n(y)}))})();